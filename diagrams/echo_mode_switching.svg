<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: echo_mode_switching Pages: 1 -->
<svg width="446pt" height="512pt"
 viewBox="0.00 0.00 445.50 512.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 508)">
<title>echo_mode_switching</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-508 441.5,-508 441.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="none" stroke="black" cx="225.5" cy="-486" rx="18" ry="18"/>
</g>
<!-- choice -->
<g id="node2" class="node">
<title>choice</title>
<polygon fill="none" stroke="black" points="225.5,-431 62.62,-413 225.5,-395 388.38,-413 225.5,-431"/>
<text text-anchor="middle" x="225.5" y="-409.3" font-family="Source Code Pro" font-size="14.00">Mode switch requested</text>
</g>
<!-- start&#45;&gt;choice -->
<g id="edge1" class="edge">
<title>start&#45;&gt;choice</title>
<path fill="none" stroke="black" d="M225.5,-467.81C225.5,-459.79 225.5,-450.05 225.5,-441.07"/>
<polygon fill="black" stroke="black" points="229,-441.03 225.5,-431.03 222,-441.03 229,-441.03"/>
</g>
<!-- ta1 -->
<g id="node3" class="node">
<title>ta1</title>
<polygon fill="none" stroke="black" points="215.5,-344 57.5,-344 57.5,-306 215.5,-306 215.5,-344"/>
<text text-anchor="middle" x="136.5" y="-328.8" font-family="Source Code Pro" font-size="14.00">Collect all messages</text>
<text text-anchor="middle" x="136.5" y="-313.8" font-family="Source Code Pro" font-size="14.00">from queue (text)</text>
</g>
<!-- choice&#45;&gt;ta1 -->
<g id="edge2" class="edge">
<title>choice&#45;&gt;ta1</title>
<path fill="none" stroke="black" d="M209.23,-396.73C202.75,-390.62 195.25,-383.5 188.5,-377 179.85,-368.67 170.47,-359.51 162.08,-351.27"/>
<polygon fill="black" stroke="black" points="164.29,-348.54 154.71,-344.02 159.39,-353.53 164.29,-348.54"/>
<text text-anchor="middle" x="232" y="-365.8" font-family="Source Code Pro" font-size="14.00">text → audio</text>
</g>
<!-- at1 -->
<g id="node7" class="node">
<title>at1</title>
<polygon fill="none" stroke="black" points="398.5,-344 234.5,-344 234.5,-306 398.5,-306 398.5,-344"/>
<text text-anchor="middle" x="316.5" y="-328.8" font-family="Source Code Pro" font-size="14.00">Ensure all transcripts</text>
<text text-anchor="middle" x="316.5" y="-313.8" font-family="Source Code Pro" font-size="14.00">are complete</text>
</g>
<!-- choice&#45;&gt;at1 -->
<g id="edge3" class="edge">
<title>choice&#45;&gt;at1</title>
<path fill="none" stroke="black" d="M249.19,-397.43C257.88,-391.58 267.53,-384.46 275.5,-377 283.46,-369.55 291.22,-360.51 297.8,-352.13"/>
<polygon fill="black" stroke="black" points="300.69,-354.12 303.96,-344.05 295.12,-349.88 300.69,-354.12"/>
<text text-anchor="middle" x="332" y="-365.8" font-family="Source Code Pro" font-size="14.00">audio → text</text>
</g>
<!-- ta2 -->
<g id="node4" class="node">
<title>ta2</title>
<polygon fill="none" stroke="black" points="217,-269 44,-269 44,-231 217,-231 217,-269"/>
<text text-anchor="middle" x="130.5" y="-253.8" font-family="Source Code Pro" font-size="14.00">Initialize Realtime</text>
<text text-anchor="middle" x="130.5" y="-238.8" font-family="Source Code Pro" font-size="14.00">WebSocket connection</text>
</g>
<!-- ta1&#45;&gt;ta2 -->
<g id="edge4" class="edge">
<title>ta1&#45;&gt;ta2</title>
<path fill="none" stroke="black" d="M135.02,-305.96C134.35,-297.88 133.56,-288.18 132.82,-279.18"/>
<polygon fill="black" stroke="black" points="136.29,-278.77 131.99,-269.09 129.32,-279.34 136.29,-278.77"/>
</g>
<!-- ta3 -->
<g id="node5" class="node">
<title>ta3</title>
<polygon fill="none" stroke="black" points="201,-194 0,-194 0,-156 201,-156 201,-194"/>
<text text-anchor="middle" x="100.5" y="-178.8" font-family="Source Code Pro" font-size="14.00">Inject conversation history</text>
<text text-anchor="middle" x="100.5" y="-163.8" font-family="Source Code Pro" font-size="14.00">as text items</text>
</g>
<!-- ta2&#45;&gt;ta3 -->
<g id="edge5" class="edge">
<title>ta2&#45;&gt;ta3</title>
<path fill="none" stroke="black" d="M123.08,-230.96C119.69,-222.71 115.6,-212.75 111.84,-203.6"/>
<polygon fill="black" stroke="black" points="114.97,-202.01 107.93,-194.09 108.5,-204.67 114.97,-202.01"/>
</g>
<!-- ta4 -->
<g id="node6" class="node">
<title>ta4</title>
<polygon fill="none" stroke="black" points="198.5,-119 20.5,-119 20.5,-81 198.5,-81 198.5,-119"/>
<text text-anchor="middle" x="109.5" y="-103.8" font-family="Source Code Pro" font-size="14.00">Begin audio interaction</text>
<text text-anchor="middle" x="109.5" y="-88.8" font-family="Source Code Pro" font-size="14.00">with full context</text>
</g>
<!-- ta3&#45;&gt;ta4 -->
<g id="edge6" class="edge">
<title>ta3&#45;&gt;ta4</title>
<path fill="none" stroke="black" d="M102.72,-155.96C103.72,-147.88 104.92,-138.18 106.03,-129.18"/>
<polygon fill="black" stroke="black" points="109.52,-129.44 107.27,-119.09 102.57,-128.59 109.52,-129.44"/>
</g>
<!-- end -->
<g id="node11" class="node">
<title>end</title>
<ellipse fill="none" stroke="black" cx="216.5" cy="-22" rx="18" ry="18"/>
<ellipse fill="none" stroke="black" cx="216.5" cy="-22" rx="22" ry="22"/>
</g>
<!-- ta4&#45;&gt;end -->
<g id="edge7" class="edge">
<title>ta4&#45;&gt;end</title>
<path fill="none" stroke="black" d="M134.86,-80.99C151.7,-69.03 173.74,-53.37 190.67,-41.34"/>
<polygon fill="black" stroke="black" points="192.88,-44.07 199.01,-35.42 188.83,-38.36 192.88,-44.07"/>
</g>
<!-- at2 -->
<g id="node8" class="node">
<title>at2</title>
<polygon fill="none" stroke="black" points="406.5,-269 240.5,-269 240.5,-231 406.5,-231 406.5,-269"/>
<text text-anchor="middle" x="323.5" y="-253.8" font-family="Source Code Pro" font-size="14.00">Close Realtime</text>
<text text-anchor="middle" x="323.5" y="-238.8" font-family="Source Code Pro" font-size="14.00">WebSocket gracefully</text>
</g>
<!-- at1&#45;&gt;at2 -->
<g id="edge8" class="edge">
<title>at1&#45;&gt;at2</title>
<path fill="none" stroke="black" d="M318.23,-305.96C319,-297.88 319.94,-288.18 320.8,-279.18"/>
<polygon fill="black" stroke="black" points="324.29,-279.38 321.77,-269.09 317.33,-278.71 324.29,-279.38"/>
</g>
<!-- at3 -->
<g id="node9" class="node">
<title>at3</title>
<polygon fill="none" stroke="black" points="437.5,-194 219.5,-194 219.5,-156 437.5,-156 437.5,-194"/>
<text text-anchor="middle" x="328.5" y="-178.8" font-family="Source Code Pro" font-size="14.00">Continue with Responses API</text>
<text text-anchor="middle" x="328.5" y="-163.8" font-family="Source Code Pro" font-size="14.00">using text history</text>
</g>
<!-- at2&#45;&gt;at3 -->
<g id="edge9" class="edge">
<title>at2&#45;&gt;at3</title>
<path fill="none" stroke="black" d="M324.74,-230.96C325.29,-222.88 325.95,-213.18 326.57,-204.18"/>
<polygon fill="black" stroke="black" points="330.07,-204.31 327.26,-194.09 323.09,-203.83 330.07,-204.31"/>
</g>
<!-- at4 -->
<g id="node10" class="node">
<title>at4</title>
<polygon fill="none" stroke="black" points="434.5,-118 218.5,-118 218.5,-82 434.5,-82 434.5,-118"/>
<text text-anchor="middle" x="326.5" y="-96.3" font-family="Source Code Pro" font-size="14.00">Maintain message continuity</text>
</g>
<!-- at3&#45;&gt;at4 -->
<g id="edge10" class="edge">
<title>at3&#45;&gt;at4</title>
<path fill="none" stroke="black" d="M328.01,-155.96C327.78,-147.7 327.51,-137.74 327.26,-128.57"/>
<polygon fill="black" stroke="black" points="330.75,-128.24 326.97,-118.33 323.75,-128.43 330.75,-128.24"/>
</g>
<!-- at4&#45;&gt;end -->
<g id="edge11" class="edge">
<title>at4&#45;&gt;end</title>
<path fill="none" stroke="black" d="M301.81,-81.94C284.18,-69.76 260.49,-53.39 242.55,-41"/>
<polygon fill="black" stroke="black" points="244.48,-38.07 234.26,-35.27 240.5,-43.83 244.48,-38.07"/>
</g>
</g>
</svg>
