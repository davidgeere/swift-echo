<?xml version="1.0" encoding="UTF-8"?>
<svg width="600" height="400" xmlns="http://www.w3.org/2000/svg">
  <!-- Echo Container -->
  <rect x="10" y="10" width="580" height="380" fill="#f8f9fa" stroke="#495057" stroke-width="2" rx="5"/>
  <text x="300" y="35" font-family="SF Pro Display, system-ui, sans-serif" font-size="18" font-weight="600" text-anchor="middle">Echo</text>
  
  <!-- Conversation Manager Container -->
  <rect x="30" y="60" width="540" height="120" fill="#e9ecef" stroke="#6c757d" stroke-width="1.5" rx="4"/>
  <text x="300" y="85" font-family="SF Pro Display, system-ui, sans-serif" font-size="14" font-weight="500" text-anchor="middle">Conversation Manager</text>
  
  <!-- Message Queue (Core) -->
  <rect x="150" y="100" width="300" height="60" fill="#fff" stroke="#007bff" stroke-width="2" rx="3"/>
  <text x="300" y="125" font-family="SF Pro Display, system-ui, sans-serif" font-size="13" font-weight="600" text-anchor="middle" fill="#007bff">Message Queue</text>
  <text x="300" y="145" font-family="SF Pro Display, system-ui, sans-serif" font-size="11" text-anchor="middle" fill="#6c757d">Ensures proper message sequencing</text>
  
  <!-- API Clients Layer -->
  <g id="api-clients">
    <!-- Realtime Client -->
    <rect x="30" y="200" width="250" height="60" fill="#fff" stroke="#28a745" stroke-width="1.5" rx="3"/>
    <text x="155" y="225" font-family="SF Pro Display, system-ui, sans-serif" font-size="13" font-weight="500" text-anchor="middle">Realtime Client</text>
    <text x="155" y="245" font-family="SF Pro Display, system-ui, sans-serif" font-size="11" text-anchor="middle" fill="#6c757d">WebSocket (Audio)</text>
    
    <!-- Responses Client -->
    <rect x="320" y="200" width="250" height="60" fill="#fff" stroke="#28a745" stroke-width="1.5" rx="3"/>
    <text x="445" y="225" font-family="SF Pro Display, system-ui, sans-serif" font-size="13" font-weight="500" text-anchor="middle">Responses Client</text>
    <text x="445" y="245" font-family="SF Pro Display, system-ui, sans-serif" font-size="11" text-anchor="middle" fill="#6c757d">REST + SSE (Text)</text>
  </g>
  
  <!-- Supporting Systems Layer -->
  <g id="supporting-systems">
    <!-- Audio System -->
    <rect x="30" y="280" width="160" height="50" fill="#fff" stroke="#17a2b8" stroke-width="1.5" rx="3"/>
    <text x="110" y="300" font-family="SF Pro Display, system-ui, sans-serif" font-size="12" text-anchor="middle">Audio System</text>
    <text x="110" y="318" font-family="SF Pro Display, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#6c757d">AVFoundation</text>
    
    <!-- Embeddings API -->
    <rect x="220" y="280" width="160" height="50" fill="#fff" stroke="#17a2b8" stroke-width="1.5" rx="3"/>
    <text x="300" y="300" font-family="SF Pro Display, system-ui, sans-serif" font-size="12" text-anchor="middle">Embeddings API</text>
    <text x="300" y="318" font-family="SF Pro Display, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#6c757d">REST</text>
    
    <!-- Tool System -->
    <rect x="410" y="280" width="160" height="50" fill="#fff" stroke="#17a2b8" stroke-width="1.5" rx="3"/>
    <text x="490" y="300" font-family="SF Pro Display, system-ui, sans-serif" font-size="12" text-anchor="middle">Tool System</text>
    <text x="490" y="318" font-family="SF Pro Display, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#6c757d">Functions &amp; MCP</text>
  </g>
  
  <!-- Event System (Bottom) -->
  <rect x="30" y="345" width="540" height="35" fill="#fff3cd" stroke="#ffc107" stroke-width="1.5" rx="3"/>
  <text x="300" y="367" font-family="SF Pro Display, system-ui, sans-serif" font-size="13" font-weight="500" text-anchor="middle">Event System</text>
  
  <!-- Connection Lines -->
  <!-- Realtime to Queue -->
  <line x1="155" y1="200" x2="225" y2="160" stroke="#6c757d" stroke-width="1" stroke-dasharray="3,2" opacity="0.5"/>
  <!-- Responses to Queue -->
  <line x1="445" y1="200" x2="375" y2="160" stroke="#6c757d" stroke-width="1" stroke-dasharray="3,2" opacity="0.5"/>
  <!-- Queue to Events -->
  <line x1="300" y1="160" x2="300" y2="345" stroke="#6c757d" stroke-width="1" stroke-dasharray="3,2" opacity="0.5"/>
  <!-- Audio to Realtime -->
  <line x1="110" y1="280" x2="155" y2="260" stroke="#6c757d" stroke-width="1" stroke-dasharray="3,2" opacity="0.5"/>
</svg>